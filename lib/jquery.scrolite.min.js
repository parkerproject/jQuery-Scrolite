/* jQuery Scrolite Plugin v0.1 alpha @author Taha PAKSU (http://www.tahapaksu.com/)*/(function(a){function c(a){a.attr("unselectable","on").addClass("unselectable")}function d(a){a.attr("unselectable",null).removeClass("unselectable")}function e(b,c,d){var e=b.scrollHeight-a(b).height(),f=parseInt(e*c/d);b.scrollTop=f}var b=function(b,f){var g=a(b),h=this,i={},j={barColor:"rgba(128,128,128,0.7)",bedColor:"rgba(128,128,128,0.5)",bedWidth:10,bedCornerRadius:5,barWidth:6,barCornerRadius:3,width:"auto",height:"auto",scrollSensitivity:4},k=jQuery.extend(j,f?f:{}),l=function(){g.wrap("<div class='scrolite' style='padding:0px;margin:0px;position:relative;display:inline-block;width:"+k.width+"px;height:"+k.height+"px;overflow:hidden;'></div>"),i.scrolite=g.closest(".scrolite"),g.wrap("<div class='scrolite-container' style='padding:0px;margin:0px;position:relative;display:inline-block;width:"+(k.width-k.bedWidth-5)+"px;height:"+k.height+"px;overflow:hidden;'></div>"),i.scrolitecontainer=a(".scrolite-container",i.scrolite),i.scrolite.append("<div class='scrolite-bed' style='position:absolute;padding:"+(k.bedWidth-k.barWidth)/2+"px;right:0px;top:0px;margin:0px;background:"+k.bedColor+";width:"+k.barWidth+"px;border-radius:"+k.bedCornerRadius+"px;'><div class='scrolite-bar' style='margin-top:0px;background-color:"+k.barColor+";width:"+k.barWidth+"px;border-radius:"+k.barCornerRadius+"px;'></div></div>"),i.scrolitebed=a(".scrolite-bed",i.scrolite),i.scrolitebar=a(".scrolite-bar",i.scrolite),i.scrolitebar.data("attached",g),i.scrolitebed.height(i.scrolite.height()-(parseInt(i.scrolitebed.css("padding-top"))+parseInt(i.scrolitebed.css("padding-top")))),i.scrolitebar.height(i.scrolitebed.innerHeight()-(parseInt(i.scrolitebed.css("padding-top"))+parseInt(i.scrolitebed.css("padding-top")))),i.scrolitebed.on("contextmenu",function(){return!1}),i.scrolitebed.get(0).onselectstart=function(){return!1}};h.refresh=function(){var a=i.scrolitecontainer.innerHeight(),b=h.scrollHeight?h.scrollHeight:g.height(),c=i.scrolitebed.innerHeight()-(parseInt(i.scrolitebed.css("padding-top"))+parseInt(i.scrolitebed.css("padding-top")));i.scrolitebar.data("maxY",c);var d=c*a/b;i.scrolitebar.height(d)};var m=function(){g.unbind("mousewheel").bind("mousewheel",function(b,c,d,f){var c=parseInt(f*k.scrollSensitivity),g=a(this).parents(".scrolite").find(".scrolite-bar");g&&(parseInt(g.css("margin-top"))-c>=0?parseInt(g.css("margin-top"))-c<=g.data("maxY")-g.outerHeight()?(g.css("margin-top",parseInt(g.css("margin-top"))-c+"px"),e(g.data("attached").closest(".scrolite-container").get(0),parseInt(g.css("margin-top")),g.data("maxY")-g.outerHeight())):(g.css("margin-top",g.data("maxY")-g.outerHeight()+"px"),e(g.data("attached").closest(".scrolite-container").get(0),g.data("maxY")-g.outerHeight(),g.data("maxY")-g.outerHeight())):(g.css("margin-top","0px"),e(g.data("attached").closest(".scrolite-container").get(0),0,g.data("maxY")-g.outerHeight())))}),i.scrolitebar.unbind("mousedown").bind("mousedown",function(b){a(document).data("scrollElement",a(this)),a(this).data("scrolling",!0),a(this).data("scrollY",b.pageY-parseInt(a(this).css("margin-top"))),c(a(this).data("attached"))}),a(document).unbind("mouseup").bind("mouseup",function(b){var c=a(document).data("scrollElement");c&&c.trigger("mouseup")}),i.scrolitebar.unbind("mouseup").bind("mouseup",function(){a(this).data("scrolling",!1),a(this).data("scrollY",null),a(document).data("scrollElement",null),d(a(this).data("attached"))}),a(document).unbind("mousemove").bind("mousemove",function(b){var c=a(document).data("scrollElement");c&&c.data("scrolling")==1&&c.data("scrollY")-b.pageY<=0&&-(c.data("scrollY")-b.pageY)+c.outerHeight()<=c.data("maxY")&&(c.css("margin-top",-(c.data("scrollY")-b.pageY)+"px"),e(c.data("attached").closest(".scrolite-container").get(0),parseInt(c.css("margin-top")),c.data("maxY")-c.outerHeight()))})};l(),h.refresh(),g.load(function(){a(this).data("scrolite").refresh()}),m()};a.fn.scrolite=function(c){return this.each(function(){var d=a(this);if(d.data("scrolite"))return d.data("scrolite");var e=new b(this,c);return d.data("scrolite",e),d.data("scrolite")})}})(jQuery)